{% extends "RingCoinAppBundle:Backoffice:default_backoffice.html.twig" %}

{% trans_default_domain 'FOSUserBundle' %}
{% trans_default_domain 'RingCoinAppBundle' %}

{% block title %}Backoffice{% endblock %}

{% block content %}


    <div class="row px-lg-5 mb-2" style="margin-top: 7rem">

        <!--Modal: Login / Register Form-->
        <div class="modal fade" id="modalLRForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog cascading-modal" role="document">
                <!--Content-->
                <div class="modal-content">

                    <!--Modal cascading tabs-->
                    <div class="modal-c-tabs">

                        <ul class="nav nav-tabs orange md-pills md-pills-mod-orange inline tabs-3 md darken-3" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" id="btc-li" data-toggle="tab" href="#panel7" role="tab">Bitcoin</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="eth-li" data-toggle="tab" href="#panel8" role="tab">Ethereum</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="ltc-li" data-toggle="tab" href="#panel9" role="tab">Litecoin</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="ltc-li" data-toggle="tab" href="#panel10" role="tab">Mobile</a>
                            </li>
                        </ul>

                        <!-- Tab panels -->
                        <div class="tab-content px-md-4 px-sm-0 px-xl-0">
                            <!--Panel 7-->
                            <div class="tab-pane fade in show active" id="panel7" role="tabpanel">

                                <div class="modal-body mb-1" id="sub-btc">
                                    <h5 class="h5-responsive">
                                        {{ 'deposit.adrDepotBtc'|trans }}
                                    </h5>
                                    <span id="adr-btcc">{{ app.user.adrBTC }}</span>
                                   <img class="mb-2" src="{{ asset('bundles/ringcoinapp/qrcode/'~app.user.adrBTC~'.png') }}"/>
                                </div>

                            </div>
                            <!--/.Panel 7-->

                            <!--Panel 8-->
                            <div class="tab-pane fade" id="panel8" role="tabpanel">

                                <div class="modal-body mb-1" id="sub-eth">
                                    <h5 class="h5-responsive">
                                        {{ 'deposit.adrDepotEth'|trans }}
                                    </h5>
                                    <span id="adr-btcc">{{ app.user.adrETH }}</span>
                                     <img class="mb-2" src="{{ asset('bundles/ringcoinapp/qrcode/'~app.user.adrETH~'.png') }}"/>
                                </div>

                            </div>
                            <!--/.Panel 8-->

                            <!--Panel 9-->
                            <div class="tab-pane fade" id="panel9" role="tabpanel">

                                <div class="modal-body mb-1" id="sub-ltc">
                                    <h5 class="h5-responsive">
                                        {{ 'deposit.adrDepotLtc'|trans }}
                                    </h5>
                                    <span id="adr-btcc">{{ app.user.adrLTC }}</span>
                                    <img class="mb-2" src="{{ asset('bundles/ringcoinapp/qrcode/'~app.user.adrLTC~'.png') }}"/>

                                </div>

                            </div>
                            <!--/.Panel 9-->

                            <!--Panel 9-->
                            <div class="tab-pane fade" id="panel10" role="tabpanel">

                                <div class="modal-body mb-1" id="sub-ltc">
                                    <h5 class="h5-responsive">
                                        {{ 'deposit.msg'|trans }}
                                    </h5>
                                    <form method="post" action="{{ path('buy_mobile_money') }}">
                                        <div class="row pt-2 pb-4">
                                            <div class="col-6">
                                                <select name="typePaiement" class="custom-select">
                                                    <option value="Orange money">Orange money</option>
                                                    <option value="MTN Mobile money">MTN Mobile money</option>
                                                </select>
                                            </div>
                                            <div class="col-6 mt-1">
                                                <b id="tel">+237690936820</b>
                                            </div>
                                        </div>

                                        <div class="md-form">
                                            <input required type="text" id="ct-object" name="idTransaction" class="form-control">
                                            <label for="ct-object">{{ 'backoffice.idTransaction'|trans }}</label>
                                        </div>
                                        <div class="md-form">
                                            <input required type="text" id="ct-object" name="numTel" class="form-control">
                                            <label for="ct-object">{{ 'backoffice.numTel'|trans }}</label>
                                        </div>
                                        <div class="md-form">
                                            <input required type="text" id="ct-object" name="mtn" class="form-control">
                                            <label for="ct-object">{{ 'backoffice.mtnFcfa'|trans }}</label>
                                        </div>
                                        <button type="submit" class="btn btn-warning btn-rounded pull-right mb-4">{{ 'deposit.valider'|trans }}</button>
                                    </form>
                                </div>

                            </div>
                            <!--/.Panel 9-->

                        </div>

                    </div>
                </div>
                <!--/.Content-->
            </div>
        </div>
        <!--Modal: Login / Register Form-->

        <div class="col-12">
            <div class="alert text-center animated fadeInRight alert-with-icon default-color darken-4 white-text alert-dismissible fade show"
                 role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <i class="fa fa-shield"></i>
                <span data-notify="message" >{{ 'backoffice.msgFlash.buyRing'|trans }}</span>
            </div>
        </div>

        {% if app.user.active==false %}
        <div class="col-lg-12 hidden-lg-up">
            <div class="alert animated fadeInRight alert-with-icon alert-warning alert-dismissible fade show"
                 role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <i class="fa fa-exclamation-triangle"></i>
                <span data-notify="message">{{ 'backoffice.msgFlash.validateEmail'|trans }}</span>
            </div>
        </div>
        {% endif %}


        <div class="col-md-4 dashboard-ls panel-h-md mx-0 px-2 mb-5 white-text">
            <div class="hm-black-strong">
                <div class="mask flex-center">
                    <div class="card px-0 mt-4">
                        <div class="card-body px-sm-2 py-sm-0">
                            <h2 class="card-title h2-responsive mb-5">{{ 'backoffice.monRingWallet'|trans }}</h2>

                            <div class="mb-3">
                                {{ 'backoffice.ringCoinBuy'|trans }} <br />

                                <span>{{ app.user.piecesAchete }}</span>
                            </div>

                            <div class="mb-3">
                                {{ 'backoffice.ringBonus'|trans }} <i class="fa fa-menu"></i> <br />
                                <span>{{ app.user.piecesBonus }}</span>
                            </div>

                            <div class="mb-3">
                                {{ 'backoffice.ringTotal'|trans }} <br />
                                <span>{{ app.user.piecesBonus + app.user.piecesAchete }}</span>
                            </div>

                            <div class="mb-5">
                                {{ 'backoffice.valeurUnitaire'|trans }}
                                <h3 class="h3-responsive mt-0">{{ data.prixRC }}$ US</h3>
                            </div>

                            <div class="text-center px-0">
                                <a style="width: 300px;" class="btn btn-orange btn-rounded btn-lg animated fadeIn infinite" data-toggle="modal" data-target="#modalLRForm">{{ 'backoffice.buy'|trans }}</a>
                            </div>

                        </div>

                    </div>
                </div>
            </div>
        </div>


        <div class="col-md-8">

            <!--First row-->
            <div class="row animated fadeInRight px-lg-5 mb-5">

                {% if app.user.active==false %}
                <div class="col-md-12 hidden-md-down">
                    <div class="alert animated fadeInUp alert-with-icon alert-warning alert-dismissible fade show"
                         role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <i class="fa fa-exclamation-triangle"></i>
                        <span data-notify="message">{{ 'backoffice.msgFlash.validateEmail'|trans }}</span>
                    </div>
                </div>
                {% endif %}
                <!--First column-->
                <div class="col-md-6 col-sm-6 mb-3">
                    <!--Card-->
                    <div class="card card-cascade cascading-admin-card">
                        <!--Card Data-->
                        <div class="admin-up">
                            <i class="fa fa-users blue darken-4"></i>
                            <div class="data">
                                <p>{{ 'backoffice.nbreFilleul'|trans }}</p>
                                <h5 class="h5-responsive">{{ data.nbreFilleuls }}</h5>
                            </div>
                        </div>
                        <!--/.Card Data-->

                        <!--Card content-->
                        <div class="card-block">
                            <div class="col-md-12">
                                <div class="progress">
                                    <div class="progress-bar blue darken-3" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>
                        <!--/.Card content-->
                    </div>
                    <!--/.Card-->
                </div>
                <!--/First column-->

                <!--Third column-->
                <div class="col-md-6 col-sm-6 mb-3">
                    <!--Card-->
                    <div class="card card-cascade cascading-admin-card">
                        <!--Card Data-->
                        <div class="admin-up">
                            <span class="fa default-color darken-4">RC</span>
                            <div class="data">
                                <p>{{ 'backoffice.totalPiece'|trans }}</p>
                                <h5 class="h5-responsive">{{ app.user.piecesBonus + app.user.piecesAchete }}</h5>
                            </div>
                        </div>
                        <!--/.Card Data-->

                        <!--Card content-->
                        <div class="card-block">
                            <div class="col-md-12">
                                <div class="progress">
                                    <div class="progress-bar default-color darken-4" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>
                        <!--/.Card content-->
                    </div>
                    <!--/.Card-->
                </div>
                <!--/Third column-->

                <!--Second column-->
                <div class="col-md-6 col-sm-6 mb-3">
                    <!--Card-->
                    <div class="card card-cascade cascading-admin-card">
                        <!--Card Data-->
                        <div class="admin-up">
                            <i class="fa fa-link default-color"></i>
                            <div class="data">
                                <p>{{ 'backoffice.lienParrainage'|trans }}</p>

                                {% if app.user.lienParrainage %}
                                    <button class="btn btn-default btn-sm btn-rounded" id="pr-btn-cp">{{ 'backoffice.copier'|trans }}</button>
                                {% else %}
                                    <a id="refLink" href="{{ path('parrainage_link') }}" class="btn btn-default btn-sm btn-rounded">{{ 'backoffice.genererLien'|trans }}</a>
                                {% endif %}

                            </div>
                        </div>
                        <!--/.Card Data-->

                        <!--Card content-->
                        <div class="card-block">
                            <div class="col-md-12">
                                {% if app.user.lienParrainage %}
                                    <p class="card-text pr-link" id="pr-link">{{ absolute_url(path('parrainage', {'code':app.user.lienParrainage})) }}</p>
                                {% endif %}
                                <div class="progress">
                                    <div class="progress-bar  default-color" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <!--Text-->

                            </div>
                        </div>
                        <!--/.Card content-->
                    </div>
                    <!--/.Card-->
                </div>
                <!--/Second column-->

                <!--Fourt column-->
                <div class="col-md-6 col-sm-6 mb-3">
                    <!--Card-->
                    <div class="card card-cascade cascading-admin-card">
                        <!--Card Data-->
                        <div class="admin-up">
                            <i class="fa fa-plus blue darken-4"></i>
                            <div class="data">
                                <p>{{ 'backoffice.bonus'|trans }}</p>
                                <h5 class="h5-responsive">+{{ app.user.piecesBonus }} RC</h5>
                            </div>
                        </div>
                        <!--/.Card Data-->

                        <!--Card content-->
                        <div class="card-block mt-lg-5 mt-md-5">
                            <div class="col-md-12 mt-md-4 mt-lg-0 mt-sm-0">
                                <div class="progress">
                                    <div class="progress-bar blue darken-4" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>
                        <!--/.Card content-->
                    </div>
                    <!--/.Card-->
                </div>
                <!--/Fourt column-->

            </div>
            <!--/First row-->
        </div>

    </div>


    <div class="row px-lg-5">
        <div class="col-md-6 dashboard-ls panel-h-sm mx-0 mb-5 white-text">
            <div class="hm-black-strong">
                <div class="mask flex-center">
                    <div class="card px-0 mt-4">

                        <div class="card-body">
                            <h2 class="card-title transition-t h2-responsive mb-2">
                                <div class="row">
                                    <div class="col-md-6">{{ 'backoffice.transactions'|trans }}</div>
                                </div>
                            </h2><br />

                            <div class="row mb-3">

                                <div class="col-md-12 mb-3 tr-bdy">
                                    {% set transactions = data.transactions %}
                                    {% include 'RingCoinAppBundle:Backoffice:transactions.html.twig' %}
                                </div>

                                <div class="col-md-12 mx-0 tr-pg">
                                    <nav>
                                        <ul class="pagination pagination-circle pg-amber white-text">
                                            <li class="page-item disabled">
                                                <a class="page-link" href="#" aria-label="Previous">
                                                    <span aria-hidden="true">&laquo;</span>
                                                    <span class="sr-only">Previous</span>
                                                </a>
                                            </li>

                                            {% for page in data.nbrePages %}
                                                <li class="page-item {% if page+1==1 %}active{% endif %}">
                                                    <a class="page-link" ><span>{{ page+1 }}</span> <span class="sr-only">(current)</span></a>
                                                </li>
                                            {% endfor %}

                                        </ul>
                                    </nav>
                                </div>

                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6 dashboard-rs panel-h-sm mx-0 px-2 mb-5 text-white">
            <div class="hm-black-strong">
                <div class="mask flex-center">
                    <div class="card px-0 mt-4">
                        <div class="card-body">
                            <h2 class="card-title h2-responsive mb-5">{{ 'backoffice.profil'|trans }}</h2>

                            <p class="my-4">
                                {{ 'backoffice.infosConfidentiel'|trans }}
                                {% if app.session.has('resp') %}
                                    {{ app.session.get('resp') }}
                                {% endif %}
                            </p>

                            <div>
                                {% set datas = [] %}
                                {% if form_errors(data.form.email) %}
                                    {% set email = form_errors(data.form.email) %}
                                    {% set datas = [email] %}
                                {% elseif form_errors(data.form.username) %}
                                    {% set username = form_errors(data.form.username) %}
                                    {% set datas = [username] %}
                                {% endif %}

                                {% if datas|length > 0 %}
                                    <div class="alert alert-danger">
                                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                        {% for data in datas %}
                                            {{ data|raw }}
                                        {% endfor %}
                                    </div>
                                {% endif %}


                                {% include "@FOSUser/Profile/edit_content.html.twig" %}
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

{% endblock %}

{% block javascripts %}
    <script>
        $(document).ready(function () {
            {#   var urlprofile = "{{ absolute_url(path('paginate_transaction',{'page': '1'})) }}";
            checkpayment("{{ absolute_url(path('backoffice_deposit', {x: 'BTC'})) }}", urlprofile, "BTC", "{{ asset('bundles/ringcoinapp/img/load.gif') }}");
            checkpayment("{{ absolute_url(path('backoffice_deposit', {x:'LTC'})) }}", urlprofile, "LTC", "{{ asset('bundles/ringcoinapp/img/load.gif') }}");
            checkpayment("{{ absolute_url(path('backoffice_deposit', {x:'ETH'})) }}", urlprofile, "ETH", "{{ asset('bundles/ringcoinapp/img/load.gif') }}");

            $('.page-item .page-link').on('click', function () {
                var y = $(this).children('span').eq(0).text();
                var url = "{{ absolute_url(path('paginate_transaction',{'page': 'id'})) }}";
                url = url.replace('id', $(this).children('span').eq(0).text());
                loaderRequest(url, '{{ asset('bundles/ringcoinapp/img/load.gif') }}', $('.tr-bdy'), $('.tr-bdy'), 2000, 'GET', '');
                $(this).parent().parent('.pagination').children('.page-item').removeClass('active');
                $(this).parent('.page-item').addClass('active');
            });#}

            {% for sms in app.session.flashbag.get('toast_success') %}
             createSnackbar('{{ sms|trans({}, 'RingCoinAppBundle') }}', 'Dismiss');
            {% endfor %}
        });

    </script>
{% endblock %}